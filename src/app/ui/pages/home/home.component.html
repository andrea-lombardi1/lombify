<div class="toolbar">
  <div class="start">
    <p-button [routerLink]="'/collection'" [style]="{ height: '40px' }">
      <span class="material-symbols"> favorite </span>
      <span>Preferiti</span>
    </p-button>
  </div>
  <div class="center">
    <input
      pInputText
      placeholder="Search"
      [(ngModel)]="query"
      (keydown)="search()"
      aria-label="search"
      style="width: 100%; max-width: 32rem; height: 40px"
      [class.ng-invalid]="query.length < 3"
    />
  </div>
  <div class="end">
    <p-select
      [options]="stateOptions"
      [(ngModel)]="value"
      optionLabel="label"
      optionValue="value"
      [showClear]="true"
      placeholder="Filtra per..."
      aria-labelledby="basic"
      (onChange)="search()"
      [style]="{ height: '40px' }"
    />
  </div>
</div>
<div class="divider"></div>
@if (query.length < 3) {
<div class="hero">
  <div class="card">
    <img src="./logo.png" alt="Card" style="margin: auto; max-width: 30rem" />
    <h1>Benvenuto su Lombify</h1>
    <p>Per la ricerca, scrivi almeno 3 caratteri... buon ascolto!</p>
  </div>
</div>
} @else if (!results) {
<div class="hero">
  <app-spinner></app-spinner>
</div>
} @else if (results.resultCount === 0) {
<p-card [style]="{ width: '30rem', overflow: 'hidden', margin: 'auto' }">
  <p-header>
    <img
      src="https://i1.wp.com/potafiori.com/wp-content/uploads/2020/04/placeholder.png?ssl=1"
      alt="Card"
      style="max-width: 30rem"
    />
  </p-header>
  <h1>0 risultati</h1>
  <p>Non ci sono risultati per la tua ricerca... prova con qualcos'altro!</p>
</p-card>
} @else { @if (!value) {
<p-table
  [value]="results.results"
  stripedRows
  [tableStyle]="{ margin: '0 0 0 16px', width: 'calc(100% - 16px)' }"
>
  <ng-template #header>
    <tr></tr>
  </ng-template>
  <ng-template #body let-row>
    <tr>
      @if (row.wrapperType == 'artist') {
      <td>
        <p-avatar
          [label]="row.artistName.charAt(0)"
          size="xlarge"
          [style]="{ width: '100px', height: '100px' }"
        />
      </td>
      <td>
        <h2>{{ row.artistName }}</h2>
      </td>
      <td>
        <p-button
          [rounded]="true"
          severity="secondary"
          [style]="{ 'font-size': '1.5rem', padding: '1rem' }"
          (onClick)="addToFavorites(row)"
        >
          <span class="material-symbols-outlined" style="font-size: 2rem">
            favorite
          </span>
        </p-button>
      </td>
      <td>
        <p-button
          [rounded]="true"
          severity="secondary"
          [style]="{ 'font-size': '1.5rem', padding: '1rem' }"
        >
          <span class="material-symbols-outlined" style="font-size: 2rem">
            account_circle
          </span>
        </p-button>
      </td>
      } @else if (row.wrapperType == 'collection') {
      <td>
        <p-avatar
          [image]="row.artworkUrl100"
          size="xlarge"
          [style]="{ width: '100px', height: 'auto' }"
        />
      </td>
      <td>
        <h2>{{ row.collectionName }}</h2>
        <h5>{{ row.releaseDate | date: 'yyyy' }}</h5>
      </td>
      <td>
        <p-button
          [rounded]="true"
          severity="secondary"
          [style]="{ 'font-size': '1.5rem', padding: '1rem' }"
        >
          <span class="material-symbols-outlined" style="font-size: 2rem">
            favorite
          </span>
        </p-button>
      </td>
      <td>
        <p-button
          [rounded]="true"
          severity="secondary"
          [style]="{ 'font-size': '1.5rem', padding: '1rem' }"
        >
          <span class="material-symbols-outlined" style="font-size: 2rem">
            collections_bookmark
          </span>
        </p-button>
      </td>
      } @else if (row.wrapperType == 'track') {
      <td>
        <p-avatar
          [image]="row.artworkUrl100"
          size="xlarge"
          [style]="{ width: '100px', height: 'auto' }"
        />
      </td>
      <td>
        <h2>{{ row.trackName }}</h2>
        <h5>{{ row.artistName }}</h5>
      </td>
      <td>
        <p-button
          [rounded]="true"
          severity="secondary"
          [style]="{ 'font-size': '1.5rem', padding: '1rem' }"
        >
          <span class="material-symbols-outlined" style="font-size: 2rem">
            favorite
          </span>
        </p-button>
      </td>
      <td>
        <p-button
          [rounded]="true"
          severity="secondary"
          [style]="{ 'font-size': '1.5rem', padding: '1rem' }"
          (click)="playSong(row.previewUrl)"
        >
          <span class="material-symbols-outlined" style="font-size: 2rem">
            play_circle
          </span>
        </p-button>
      </td>
      }
    </tr>
  </ng-template>
</p-table>
} @else if (value === 'musicArtist') {
<!-- Table -->
<p-table
  [value]="results.results"
  stripedRows
  [tableStyle]="{ margin: '0 0 0 16px', width: 'calc(100% - 16px)' }"
>
  <ng-template #header>
    <tr></tr>
  </ng-template>
  <ng-template #body let-row>
    <tr>
      <td>
        <p-avatar
          [label]="row.artistName.charAt(0)"
          size="xlarge"
          [style]="{ width: '100px', height: '100px' }"
        />
      </td>
      <td>
        <h2>{{ row.artistName }}</h2>
        <h5>{{ row.primaryGenreName }}</h5>
      </td>
      <td>
        <p-button
          [rounded]="true"
          severity="secondary"
          [style]="{ 'font-size': '1.5rem', padding: '1rem' }"
        >
          <span class="material-symbols-outlined" style="font-size: 2rem">
            favorite
          </span>
        </p-button>
      </td>
      <td>
        <p-button
          [rounded]="true"
          severity="secondary"
          [style]="{ 'font-size': '1.5rem', padding: '1rem' }"
        >
          <span class="material-symbols-outlined" style="font-size: 2rem">
            account_circle
          </span>
        </p-button>
      </td>
    </tr>
  </ng-template>
</p-table>
} @else if (value === 'album') {
<!-- Card grid -->
<div
  class="card-grid"
  style="
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
  "
>
  @for (album of results.results; track album.collectionId) {
  <div
    class="card"
    style="
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    "
  >
    <img
      [src]="album.artworkUrl100"
      alt="Card"
      style="width: 100%; height: auto; border-radius: 8px"
    />
    <h1 style="font-size: 1.2rem; margin: 0.5rem 0">
      {{ album.collectionName }}
    </h1>
    <p style="font-size: 1rem; color: gray">{{ album.artistName }}</p>
  </div>
  }
</div>
} @else if (value === 'musicTrack') {
<!-- Card grid -->
<div
  class="card-grid"
  style="
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
  "
>
  @for (track of results.results; track track.trackId) {
  <div
    class="card"
    style="
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    "
  >
    <img
      [src]="track.artworkUrl100"
      alt="Card"
      style="width: 100%; height: auto; border-radius: 8px"
    />
    <h1 style="font-size: 1.2rem; margin: 0.5rem 0">{{ track.trackName }}</h1>
    <p style="font-size: 1rem; color: gray">{{ track.artistName }}</p>
    <p-button
      [rounded]="true"
      severity="secondary"
      [style]="{
        'font-size': '1.5rem',
        padding: '1rem',
        'margin-top': '0.5rem'
      }"
      (click)="playSong(track.previewUrl)"
    >
      <span class="material-symbols-outlined" style="font-size: 2rem">
        play_circle
      </span>
    </p-button>
  </div>
  }
</div>
} }

<div class="divider"></div>
<div class="bottombar">
  <div class="start">
    <p-button>
      <span class="material-symbols"> play_arrow </span>
    </p-button>
  </div>
  <div class="center">
    <p>Titolo</p>
  </div>
  <div class="end">
    <p-button>
      <span class="material-symbols"> expand_content </span>
    </p-button>
    <p-button>
      <span class="material-symbols"> close </span>
    </p-button>
  </div>
</div>
